# Abgabe Übung 04
> **Arvo Klöck | 909003**  
> **06.11.2024**

```python
# Berechnung der Varianzen (quadrierte Standardabweichungen)
varianzen = genauigkeiten.applyfunc(lambda x: x**2)

# Berechnung der Kehrwerte der Varianzen (Gewichte)
gewichte = varianzen.applyfunc(lambda x: 1/x)

# Gewichtsmatrix P
P = sp.diag(*gewichte)

# Berechnung der transponierten Matrix A
A_T = A.T

# Normalgleichungsmatrix mit und ohne Gewichte
N = A_T * A
N_P = A_T * P * A

# Kofaktormatrix Q aus der invertierten Matrix N_P
Q = N_P.inv()

# Berechnung der Koeffizienten (Steigung m und Achsenabschnitt n) für die Geradengleichung
ATPA = A_T * P * A
ATPA_inv = ATPA.inv()
x = ATPA_inv * (A_T * P * b)

# Parameter der Geraden (x[0] = m, x[1] = n)
m = x[0]
n = x[1]

# Vektor der geschätzten Modellwerte (l)
l = A * x

# Vektor der Verbesserungen (v)
v = b - l

# Funktion zur Berechnung der Geradengleichung für einen gegebenen x-Wert
def lineare_funktion(x_wert, m, n):
    return m * x_wert + n

# Beispiel x-Wert zur Berechnung
x_wert = 234.22
y_wert = lineare_funktion(x_wert, m, n)
```

> **Für den x-Ausgangswert =** 234.220 beträgt der (verbesserte) y-Wert: 102.698  
> **Funktionsgleichung: f(x)** = -0.00043x + 102.79799


**Designmatrix A:**  
  
[[202.170000000000, 1.00000000000000],  
[204.040000000000, 1.00000000000000],  
[209.980000000000, 1.00000000000000],  
[213.520000000000, 1.00000000000000],  
[214.890000000000, 1.00000000000000],  
[217.010000000000, 1.00000000000000],  
[220.330000000000, 1.00000000000000],  
[225.060000000000, 1.00000000000000],  
[227.880000000000, 1.00000000000000],  
[233.010000000000, 1.00000000000000],  
[234.220000000000, 1.00000000000000]])
  
**Transponierte Matrix A_T:**  
  
[[202.170000000000, 204.040000000000, 209.980000000000, 213.520000000000, 214.890000000000, 217.010000000000, 220.330000000000, 225.060000000000, 227.880000000000, 233.010000000000, 234.220000000000],  
[1.00000000000000, 1.00000000000000, 1.00000000000000, 1.00000000000000, 1.00000000000000, 1.00000000000000, 1.00000000000000, 1.00000000000000, 1.00000000000000, 1.00000000000000, 1.00000000000000]])

b-Vektor:  
  
[[102.713000000000],  
[102.712000000000],  
[102.707000000000],  
[102.710000000000],  
[102.711000000000],  
[102.702000000000],  
[102.702000000000],  
[102.700000000000],  
[102.701000000000],  
[102.699000000000],  
[102.703000000000]])

**Gewichtsmatrix P:**  
  
[[40000.0000000000, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],  
[0, 111111.111111111, 0, 0, 0, 0, 0, 0, 0, 0, 0],  
[0, 0, 111111.111111111, 0, 0, 0, 0, 0, 0, 0, 0],  
[0, 0, 0, 40000.0000000000, 0, 0, 0, 0, 0, 0, 0],  
[0, 0, 0, 0, 40000.0000000000, 0, 0, 0, 0, 0, 0],  
[0, 0, 0, 0, 0, 111111.111111111, 0, 0, 0, 0, 0],  
[0, 0, 0, 0, 0, 0, 111111.111111111, 0, 0, 0, 0],  
[0, 0, 0, 0, 0, 0, 0, 111111.111111111, 0, 0, 0],  
[0, 0, 0, 0, 0, 0, 0, 0, 111111.111111111, 0, 0],  
[0, 0, 0, 0, 0, 0, 0, 0, 0, 62500.0000000000, 0],  
[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 40000.0000000000]])

**Normalgleichungsmatrix N:**  
  
[[525737.748900000, 2402.11000000000],  
[2402.11000000000, 11.0000000000000]])


**Normalgleichungsmatrix mit Gewichten N_P:**  
  
[[42442681326.0278, 194077347.222222],  
[194077347.222222, 889166.666666667]])
  
**Kofaktormatrix Q:**  
  
[[1.22473441353362e-8, -2.67321318872017e-6],  
[-2.67321318872017e-6, 0.000584603701097959]])

**Koeffizienten x:**  
   
[[-0.000427887073840338],  
[102.797987653074]])

**Geschätzte Modellwerte l:**  
   
[[102.711481723355],  
[102.710681574527],  
[102.708139925309],  
[102.706625205067],  
[102.706038999776],  
[102.705131879179],  
[102.703711294094],  
[102.701687388235], 
[102.700480746687],  
[102.698285685998],  
[102.697767942639]])

**Verbesserungen v:**  
  
[[0.00151827664478787],  
[0.00131842547287420],  
[-0.00113992530852158],  
[0.00337479493288129],  
[0.00496100022404278],  
[-0.00313187917942059],  
[-0.00171129409426385],  
[-0.00168738823499837],  
[0.000519253313228774],  
[0.000714314002024707],  
[0.00523205736138266]])
